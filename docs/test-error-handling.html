<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”™è¯¯å¤„ç†æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section h2 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        .test-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .test-button:hover {
            background: #45a049;
        }
        .test-button.danger {
            background: #f44336;
        }
        .test-button.danger:hover {
            background: #da190b;
        }
        .log-area {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #4CAF50;
            padding-left: 10px;
        }
        .log-entry.error {
            border-left-color: #f44336;
            color: #ff6b6b;
        }
        .log-entry.warn {
            border-left-color: #ff9800;
            color: #ffa726;
        }
        .log-entry.info {
            border-left-color: #2196F3;
            color: #64b5f6;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status.pass {
            background: #4CAF50;
            color: white;
        }
        .status.fail {
            background: #f44336;
            color: white;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª JavaScript é”™è¯¯å¤„ç†æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>1. åŸºç¡€é”™è¯¯æ•è·æµ‹è¯•</h2>
        <p>æµ‹è¯•å…¨å±€é”™è¯¯å¤„ç†å™¨æ˜¯å¦èƒ½æ•è·å„ç§ç±»å‹çš„é”™è¯¯</p>
        <button class="test-button danger" onclick="testSyntaxError()">è§¦å‘è¯­æ³•é”™è¯¯</button>
        <button class="test-button danger" onclick="testReferenceError()">è§¦å‘å¼•ç”¨é”™è¯¯</button>
        <button class="test-button danger" onclick="testTypeError()">è§¦å‘ç±»å‹é”™è¯¯</button>
        <button class="test-button" onclick="testNormalFunction()">æ­£å¸¸å‡½æ•°è°ƒç”¨</button>
    </div>
    
    <div class="test-section">
        <h2>2. Promise é”™è¯¯å¤„ç†æµ‹è¯•</h2>
        <p>æµ‹è¯•æœªå¤„ç†çš„ Promise æ‹’ç»æ˜¯å¦è¢«æ•è·</p>
        <button class="test-button danger" onclick="testPromiseRejection()">è§¦å‘ Promise æ‹’ç»</button>
        <button class="test-button danger" onclick="testAsyncError()">è§¦å‘ Async é”™è¯¯</button>
        <button class="test-button" onclick="testPromiseSuccess()">æ­£å¸¸ Promise</button>
    </div>
    
    <div class="test-section">
        <h2>3. èµ„æºåŠ è½½é”™è¯¯æµ‹è¯•</h2>
        <p>æµ‹è¯•å›¾ç‰‡ã€è„šæœ¬ç­‰èµ„æºåŠ è½½å¤±è´¥æ˜¯å¦è¢«æ•è·</p>
        <button class="test-button danger" onclick="testImageLoadError()">è§¦å‘å›¾ç‰‡åŠ è½½é”™è¯¯</button>
        <button class="test-button danger" onclick="testScriptLoadError()">è§¦å‘è„šæœ¬åŠ è½½é”™è¯¯</button>
        <button class="test-button" onclick="testImageLoadSuccess()">æ­£å¸¸å›¾ç‰‡åŠ è½½</button>
    </div>
    
    <div class="test-section">
        <h2>4. å¤–éƒ¨åº“ä¾èµ–æµ‹è¯•</h2>
        <p>æµ‹è¯•å¤–éƒ¨åº“æœªåŠ è½½æ—¶çš„é™çº§å¤„ç†</p>
        <button class="test-button" onclick="testTypedJsFallback()">æµ‹è¯• Typed.js é™çº§</button>
        <button class="test-button" onclick="testAnimeJsFallback()">æµ‹è¯• anime.js é™çº§</button>
        <button class="test-button" onclick="testIntersectionObserverFallback()">æµ‹è¯• IntersectionObserver é™çº§</button>
    </div>
    
    <div class="test-section">
        <h2>5. é”™è¯¯æ—¥å¿—</h2>
        <button class="test-button" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
        <button class="test-button" onclick="exportLog()">å¯¼å‡ºæ—¥å¿—</button>
        <div id="log-area" class="log-area">
            <div class="log-entry info">ç­‰å¾…æµ‹è¯•...</div>
        </div>
    </div>
    
    <script src="main.js"></script>
    <script>
        // è‡ªå®šä¹‰æ—¥å¿—è®°å½•
        const logArea = document.getElementById('log-area');
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;
        const originalConsoleLog = console.log;
        
        function addLog(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logArea.appendChild(entry);
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        // æ‹¦æˆª console æ–¹æ³•
        console.error = function(...args) {
            addLog(args.join(' '), 'error');
            originalConsoleError.apply(console, args);
        };
        
        console.warn = function(...args) {
            addLog(args.join(' '), 'warn');
            originalConsoleWarn.apply(console, args);
        };
        
        console.log = function(...args) {
            addLog(args.join(' '), 'info');
            originalConsoleLog.apply(console, args);
        };
        
        // æµ‹è¯•å‡½æ•°
        function testSyntaxError() {
            addLog('æµ‹è¯•: è§¦å‘è¯­æ³•é”™è¯¯', 'info');
            try {
                eval('var x = {');
            } catch (e) {
                addLog('âœ“ è¯­æ³•é”™è¯¯å·²æ•è·: ' + e.message, 'error');
            }
        }
        
        function testReferenceError() {
            addLog('æµ‹è¯•: è§¦å‘å¼•ç”¨é”™è¯¯', 'info');
            try {
                nonExistentFunction();
            } catch (e) {
                addLog('âœ“ å¼•ç”¨é”™è¯¯å·²æ•è·: ' + e.message, 'error');
            }
        }
        
        function testTypeError() {
            addLog('æµ‹è¯•: è§¦å‘ç±»å‹é”™è¯¯', 'info');
            try {
                null.toString();
            } catch (e) {
                addLog('âœ“ ç±»å‹é”™è¯¯å·²æ•è·: ' + e.message, 'error');
            }
        }
        
        function testNormalFunction() {
            addLog('æµ‹è¯•: æ­£å¸¸å‡½æ•°è°ƒç”¨', 'info');
            const result = 1 + 1;
            addLog('âœ“ æ­£å¸¸æ‰§è¡Œå®Œæˆï¼Œç»“æœ: ' + result, 'info');
        }
        
        function testPromiseRejection() {
            addLog('æµ‹è¯•: Promise æ‹’ç»', 'info');
            Promise.reject(new Error('æµ‹è¯• Promise æ‹’ç»'));
            addLog('Promise æ‹’ç»å·²è§¦å‘ï¼Œç­‰å¾…å…¨å±€å¤„ç†å™¨æ•è·...', 'warn');
        }
        
        async function testAsyncError() {
            addLog('æµ‹è¯•: Async å‡½æ•°é”™è¯¯', 'info');
            try {
                await Promise.reject(new Error('Async å‡½æ•°é”™è¯¯'));
            } catch (e) {
                addLog('âœ“ Async é”™è¯¯å·²æ•è·: ' + e.message, 'error');
            }
        }
        
        function testPromiseSuccess() {
            addLog('æµ‹è¯•: æ­£å¸¸ Promise', 'info');
            Promise.resolve('æˆåŠŸ')
                .then(result => {
                    addLog('âœ“ Promise æ­£å¸¸æ‰§è¡Œ: ' + result, 'info');
                });
        }
        
        function testImageLoadError() {
            addLog('æµ‹è¯•: å›¾ç‰‡åŠ è½½é”™è¯¯', 'info');
            const img = document.createElement('img');
            img.src = 'non-existent-image.jpg';
            img.onerror = () => {
                addLog('âœ“ å›¾ç‰‡åŠ è½½é”™è¯¯å·²æ•è·', 'error');
            };
            document.body.appendChild(img);
            setTimeout(() => document.body.removeChild(img), 100);
        }
        
        function testScriptLoadError() {
            addLog('æµ‹è¯•: è„šæœ¬åŠ è½½é”™è¯¯', 'info');
            const script = document.createElement('script');
            script.src = 'non-existent-script.js';
            script.onerror = () => {
                addLog('âœ“ è„šæœ¬åŠ è½½é”™è¯¯å·²æ•è·', 'error');
            };
            document.head.appendChild(script);
            setTimeout(() => document.head.removeChild(script), 100);
        }
        
        function testImageLoadSuccess() {
            addLog('æµ‹è¯•: æ­£å¸¸å›¾ç‰‡åŠ è½½', 'info');
            const img = document.createElement('img');
            img.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100"%3E%3Crect fill="%234CAF50" width="100" height="100"/%3E%3C/svg%3E';
            img.onload = () => {
                addLog('âœ“ å›¾ç‰‡åŠ è½½æˆåŠŸ', 'info');
            };
            document.body.appendChild(img);
            setTimeout(() => document.body.removeChild(img), 100);
        }
        
        function testTypedJsFallback() {
            addLog('æµ‹è¯•: Typed.js é™çº§å¤„ç†', 'info');
            if (typeof Typed === 'undefined') {
                addLog('âœ“ Typed.js æœªåŠ è½½ï¼Œé™çº§æ–¹æ¡ˆå·²å¯ç”¨', 'warn');
            } else {
                addLog('âœ“ Typed.js å·²åŠ è½½', 'info');
            }
        }
        
        function testAnimeJsFallback() {
            addLog('æµ‹è¯•: anime.js é™çº§å¤„ç†', 'info');
            if (typeof anime === 'undefined') {
                addLog('âœ“ anime.js æœªåŠ è½½ï¼Œé™çº§æ–¹æ¡ˆå·²å¯ç”¨', 'warn');
            } else {
                addLog('âœ“ anime.js å·²åŠ è½½', 'info');
            }
        }
        
        function testIntersectionObserverFallback() {
            addLog('æµ‹è¯•: IntersectionObserver å…¼å®¹æ€§', 'info');
            if (!('IntersectionObserver' in window)) {
                addLog('âœ“ IntersectionObserver ä¸æ”¯æŒï¼Œé™çº§æ–¹æ¡ˆå·²å¯ç”¨', 'warn');
            } else {
                addLog('âœ“ IntersectionObserver æ”¯æŒ', 'info');
            }
        }
        
        function clearLog() {
            logArea.innerHTML = '<div class="log-entry info">æ—¥å¿—å·²æ¸…ç©º</div>';
        }
        
        function exportLog() {
            const logs = Array.from(logArea.children).map(el => el.textContent).join('\n');
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `error-test-log-${Date.now()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            addLog('âœ“ æ—¥å¿—å·²å¯¼å‡º', 'info');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆ
        window.addEventListener('load', () => {
            addLog('âœ“ é¡µé¢åŠ è½½å®Œæˆï¼Œé”™è¯¯å¤„ç†ç³»ç»Ÿå·²å°±ç»ª', 'info');
            addLog('ErrorHandler ç±»æ˜¯å¦å­˜åœ¨: ' + (typeof ErrorHandler !== 'undefined' ? 'æ˜¯' : 'å¦'), 'info');
        });
    </script>
</body>
</html>
